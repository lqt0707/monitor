<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitor SDK Web ä½¿ç”¨ç¤ºä¾‹</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }

        .container {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .example-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            background: #f8f9fa;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
        }

        .button {
            background: #0366d6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }

        .button:hover {
            background: #0256cc;
        }

        .button.danger {
            background: #d73a49;
        }

        .button.danger:hover {
            background: #cb2431;
        }

        .status {
            background: #f1f8ff;
            border: 1px solid #c8e1ff;
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
        }

        .log {
            background: #fffbdd;
            border: 1px solid #ffd33d;
            border-radius: 6px;
            padding: 10px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }

        h1 {
            color: #24292e;
        }

        h2 {
            color: #0366d6;
            border-bottom: 2px solid #e1e4e8;
            padding-bottom: 10px;
        }

        h3 {
            color: #586069;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸš€ Monitor SDK Web ä½¿ç”¨ç¤ºä¾‹</h1>

        <div class="example-section">
            <h2>ğŸ“¦ å®‰è£…æ–¹å¼å¯¹æ¯”</h2>
            <h3>æ¨èæ–¹å¼ï¼ˆWebä¸“ç”¨åŒ…ï¼‰</h3>
            <div class="code-block">npm install @monitor/web-sdk
                import Monitor from '@monitor/web-sdk';</div>

            <h3>é€šç”¨æ–¹å¼ï¼ˆå¤šå¹³å°åŒ…ï¼‰</h3>
            <div class="code-block">npm install @monitor/sdk
                import Monitor from '@monitor/sdk';</div>

            <div class="status">
                ğŸ’¡ <strong>åŒ…å¤§å°å¯¹æ¯”ï¼š</strong><br>
                â€¢ @monitor/web-sdk: ~15KB (æ¨èWebé¡¹ç›®ä½¿ç”¨)<br>
                â€¢ @monitor/sdk: ~20KB (æ”¯æŒå¤šå¹³å°è‡ªåŠ¨æ£€æµ‹)
            </div>
        </div>

        <div class="example-section">
            <h2>ğŸ¯ å¿«é€Ÿå¼€å§‹ç¤ºä¾‹</h2>

            <h3>æ–¹å¼1: ä½¿ç”¨é…ç½®æ¨¡æ¿ï¼ˆæ¨èï¼‰</h3>
            <div class="code-block">import Monitor, { Templates } from '@monitor/web-sdk';

                // ä½¿ç”¨WebåŸºç¡€æ¨¡æ¿
                const config = Templates.createConfig(Templates.WebBasic, {
                projectId: 'demo-project',
                serverUrl: 'https://api.example.com'
                });

                Monitor.init(config);</div>

            <h3>æ–¹å¼2: ä¸€é”®å¿«é€Ÿå¼€å§‹</h3>
            <div class="code-block">import Monitor from '@monitor/web-sdk';

                // è¶…ç®€å•çš„ä½¿ç”¨æ–¹å¼
                Monitor.quickStart.web('demo-project', 'https://api.example.com');</div>

            <h3>æ–¹å¼3: è‡ªå®šä¹‰é…ç½®</h3>
            <div class="code-block">import Monitor from '@monitor/web-sdk';

                Monitor.init({
                projectId: 'demo-project',
                serverUrl: 'https://api.example.com',

                // é”™è¯¯ç›‘æ§
                error: {
                enabled: true,
                captureConsole: true,
                maxErrors: 100
                },

                // æ€§èƒ½ç›‘æ§
                performance: {
                enabled: true,
                captureNavigation: true,
                captureLCP: true
                },

                // è¡Œä¸ºç›‘æ§
                behavior: {
                enabled: true,
                captureClicks: true,
                capturePageViews: true
                }
                });</div>
        </div>

        <div class="example-section">
            <h2>ğŸ§ª å®æ—¶æµ‹è¯•</h2>
            <p>åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­å¯ä»¥çœ‹åˆ°SDKçš„åˆå§‹åŒ–å’Œè¿è¡Œæ—¥å¿—ã€‚</p>

            <div id="sdk-status" class="status">
                SDKçŠ¶æ€ï¼š<span id="status-text">æœªåˆå§‹åŒ–</span>
            </div>

            <div>
                <button class="button" onclick="initSDK()">åˆå§‹åŒ– SDK</button>
                <button class="button" onclick="testError()">æµ‹è¯•é”™è¯¯æ•è·</button>
                <button class="button" onclick="testPerformance()">æµ‹è¯•æ€§èƒ½è®°å½•</button>
                <button class="button" onclick="testBehavior()">æµ‹è¯•è¡Œä¸ºè®°å½•</button>
                <button class="button danger" onclick="testErrorCapture()">è§¦å‘é”™è¯¯</button>
                <button class="button" onclick="getStatus()">è·å–çŠ¶æ€</button>
                <button class="button" onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
            </div>

            <div id="log" class="log">
                æ—¥å¿—è¾“å‡ºåŒºåŸŸ...
                ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æµ‹è¯•ä¸åŒåŠŸèƒ½
            </div>
        </div>

        <div class="example-section">
            <h2>ğŸ’¡ æœ€ä½³å®è·µ</h2>

            <h3>1. ç¯å¢ƒåŒºåˆ†</h3>
            <div class="code-block">// åªåœ¨ç”Ÿäº§ç¯å¢ƒå¯ç”¨
                if (process.env.NODE_ENV === 'production') {
                Monitor.init(config);
                }</div>

            <h3>2. é”™è¯¯è¿‡æ»¤</h3>
            <div class="code-block">Monitor.init({
                // ...å…¶ä»–é…ç½®
                error: {
                enabled: true,
                filters: [
                // è¿‡æ»¤æ‰ç¬¬ä¸‰æ–¹è„šæœ¬é”™è¯¯
                error => !error.message.includes('Script error'),
                // è¿‡æ»¤æ‰å¼€å‘ç¯å¢ƒé”™è¯¯
                error => !error.stack?.includes('webpack')
                ]
                }
                });</div>

            <h3>3. æ€§èƒ½ç›‘æ§é…ç½®</h3>
            <div class="code-block">Monitor.init({
                // ...å…¶ä»–é…ç½®
                performance: {
                enabled: true,
                thresholds: {
                lcp: 2500, // LCPé˜ˆå€¼ 2.5ç§’
                fcp: 1800 // FCPé˜ˆå€¼ 1.8ç§’
                },
                sampleRate: 0.1 // 10%é‡‡æ ·ç‡
                }
                });</div>

            <h3>4. è‡ªå®šä¹‰æ ‡ç­¾</h3>
            <div class="code-block">Monitor.init({
                // ...å…¶ä»–é…ç½®
                tags: {
                version: '1.2.3',
                feature: 'checkout',
                experiment: 'variant-a'
                }
                });</div>
        </div>

        <div class="example-section">
            <h2>ğŸ”§ å¸¸è§é—®é¢˜è§£å†³</h2>

            <h3>é—®é¢˜1ï¼šåŒ…ä½“ç§¯è¿‡å¤§</h3>
            <div class="status">
                <strong>è§£å†³æ–¹æ¡ˆï¼š</strong> ä½¿ç”¨å¹³å°ä¸“ç”¨åŒ…<br>
                â€¢ Webé¡¹ç›®ï¼š<code>@monitor/web-sdk</code> (15KB)<br>
                â€¢ Taroé¡¹ç›®ï¼š<code>@monitor/taro-sdk</code> (12KB)
            </div>

            <h3>é—®é¢˜2ï¼šTypeScriptç±»å‹é—®é¢˜</h3>
            <div class="code-block">// ç¡®ä¿å®‰è£…äº†ç±»å‹å®šä¹‰
                npm install @types/node

                // åœ¨tsconfig.jsonä¸­æ·»åŠ 
                {
                "compilerOptions": {
                "moduleResolution": "node",
                "esModuleInterop": true
                }
                }</div>

            <h3>é—®é¢˜3ï¼šæ„å»ºé”™è¯¯</h3>
            <div class="status">
                <strong>å¸¸è§åŸå› ï¼š</strong><br>
                â€¢ ç¼ºå°‘å¿…è¦çš„polyfill<br>
                â€¢ æ‰“åŒ…å·¥å…·é…ç½®é—®é¢˜<br>
                â€¢ ä¾èµ–ç‰ˆæœ¬å†²çª<br><br>
                <strong>è§£å†³æ–¹æ¡ˆï¼š</strong> æŸ¥çœ‹ <code>./TROUBLESHOOTING.md</code>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡æ‹ŸMonitor SDKï¼ˆç”¨äºæ¼”ç¤ºï¼‰
        let isInitialized = false;
        let mockMonitor = null;

        function log(message) {
            const logElement = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logElement.textContent += `[${timestamp}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(`[Monitor Demo] ${message}`);
        }

        function updateStatus(status) {
            document.getElementById('status-text').textContent = status;
        }

        function clearLog() {
            document.getElementById('log').textContent = 'æ—¥å¿—å·²æ¸…ç©º...\n';
        }

        function initSDK() {
            if (isInitialized) {
                log('SDK å·²ç»åˆå§‹åŒ–è¿‡äº†');
                return;
            }

            log('ğŸš€ æ­£åœ¨åˆå§‹åŒ– Monitor SDK...');
            log('ğŸŒ æ£€æµ‹åˆ° Web ç¯å¢ƒ');
            log('âœ… SDK åˆå§‹åŒ–æˆåŠŸ');

            // æ¨¡æ‹ŸSDKå¯¹è±¡
            mockMonitor = {
                captureError: (error, extra) => {
                    log(`ğŸ“ æ•è·é”™è¯¯: ${error.message}`);
                    if (extra) log(`   é¢å¤–ä¿¡æ¯: ${JSON.stringify(extra)}`);
                },
                recordPerformance: (name, metrics) => {
                    log(`âš¡ è®°å½•æ€§èƒ½: ${name} - ${JSON.stringify(metrics)}`);
                },
                recordBehavior: (event, data) => {
                    log(`ğŸ‘† è®°å½•è¡Œä¸º: ${event} - ${JSON.stringify(data || {})}`);
                },
                getStatus: () => ({
                    initialized: true,
                    enabled: true,
                    queue: { size: 3, maxSize: 100 },
                    errorMonitor: true,
                    performanceMonitor: true,
                    behaviorMonitor: true
                })
            };

            isInitialized = true;
            updateStatus('å·²åˆå§‹åŒ– âœ…');
        }

        function testError() {
            if (!isInitialized) {
                log('âŒ è¯·å…ˆåˆå§‹åŒ–SDK');
                return;
            }

            const error = new Error('è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é”™è¯¯');
            mockMonitor.captureError(error, {
                userId: '12345',
                page: '/demo',
                action: 'test'
            });
        }

        function testPerformance() {
            if (!isInitialized) {
                log('âŒ è¯·å…ˆåˆå§‹åŒ–SDK');
                return;
            }

            mockMonitor.recordPerformance('page_load', {
                duration: 1234,
                lcp: 1800,
                fcp: 900
            });
        }

        function testBehavior() {
            if (!isInitialized) {
                log('âŒ è¯·å…ˆåˆå§‹åŒ–SDK');
                return;
            }

            mockMonitor.recordBehavior('button_click', {
                buttonText: 'æµ‹è¯•æŒ‰é’®',
                page: '/demo'
            });
        }

        function testErrorCapture() {
            if (!isInitialized) {
                log('âŒ è¯·å…ˆåˆå§‹åŒ–SDK');
                return;
            }

            // æ•…æ„è§¦å‘ä¸€ä¸ªé”™è¯¯æ¥æµ‹è¯•è‡ªåŠ¨æ•è·
            try {
                throw new Error('è¿™æ˜¯ä¸€ä¸ªæ•…æ„è§¦å‘çš„é”™è¯¯');
            } catch (error) {
                mockMonitor.captureError(error, {
                    type: 'intentional',
                    source: 'demo'
                });
            }
        }

        function getStatus() {
            if (!isInitialized) {
                log('âŒ è¯·å…ˆåˆå§‹åŒ–SDK');
                return;
            }

            const status = mockMonitor.getStatus();
            log(`ğŸ“Š SDKçŠ¶æ€: ${JSON.stringify(status, null, 2)}`);
        }

        // é¡µé¢åŠ è½½å®Œæˆæ—¶çš„æç¤º
        window.addEventListener('load', () => {
            log('ğŸ‰ Demoé¡µé¢åŠ è½½å®Œæˆ');
            log('ğŸ’¡ æç¤ºï¼šç‚¹å‡»"åˆå§‹åŒ– SDK"å¼€å§‹æµ‹è¯•');
        });
    </script>
</body>

</html>