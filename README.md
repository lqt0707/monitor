# å‰ç«¯ç›‘æ§ç³»ç»Ÿ (Frontend Monitoring System)

ä¸€ä¸ªå®Œæ•´çš„å‰ç«¯ç›‘æ§è§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«é”™è¯¯ç›‘æ§ã€æ€§èƒ½ç›‘æ§ã€ç”¨æˆ·è¡Œä¸ºè¿½è¸ªç­‰åŠŸèƒ½ã€‚æ”¯æŒ Webã€å°ç¨‹åºç­‰å¤šç§å‰ç«¯ç¯å¢ƒã€‚

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

### ğŸš€ ä¸»è¦åŠŸèƒ½

- **é”™è¯¯ç›‘æ§**: JavaScript é”™è¯¯ã€Promise å¼‚å¸¸ã€ç½‘ç»œè¯·æ±‚é”™è¯¯ç­‰
- **æ€§èƒ½ç›‘æ§**: é¡µé¢åŠ è½½æ—¶é—´ã€èµ„æºåŠ è½½æ€§èƒ½ã€ç”¨æˆ·äº¤äº’å“åº”æ—¶é—´
- **ç”¨æˆ·è¡Œä¸ºè¿½è¸ª**: ç‚¹å‡»ã€é¡µé¢è·³è½¬ã€è‡ªå®šä¹‰äº‹ä»¶ç­‰
- **å®æ—¶æ•°æ®ä¸ŠæŠ¥**: æ”¯æŒå•æ¡å’Œæ‰¹é‡æ•°æ®ä¸ŠæŠ¥
- **å¤šç«¯æ”¯æŒ**: Webã€Taro å°ç¨‹åºã€åŸç”Ÿå°ç¨‹åº
- **ç®¡ç†åå°**: å®Œæ•´çš„æ•°æ®å¯è§†åŒ–å’Œç®¡ç†ç•Œé¢

### ğŸ—ï¸ é¡¹ç›®æ¶æ„

```
monitor/
â”œâ”€â”€ server/              # åç«¯æœåŠ¡ (NestJS)
â”œâ”€â”€ admin/               # ç®¡ç†åå° (React + TypeScript)
â”œâ”€â”€ sdk/
â”‚   â”œâ”€â”€ web/            # Webç«¯SDK
â”‚   â””â”€â”€ taroWechatMini/ # Taroå¾®ä¿¡å°ç¨‹åºSDK
â”œâ”€â”€ example/            # ç¤ºä¾‹é¡¹ç›®
â””â”€â”€ docs/               # æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 14.0.0
- npm >= 6.0.0
- å¯ç”¨çš„ 3001 å’Œ 5173 ç«¯å£

### ä¸€é”®å¯åŠ¨

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd monitor

# å¯åŠ¨å®Œæ•´å¼€å‘ç¯å¢ƒ
npm start
```

### åˆ†æ­¥å¯åŠ¨

```bash
# 1. å®‰è£…ä¾èµ–
npm run deps:install

# 2. æ„å»ºSDK
npm run deps:build

# 3. å¯åŠ¨æœåŠ¡ç«¯
npm run server

# 4. å¯åŠ¨ç®¡ç†åå°
npm run admin
```

### å…¶ä»–å¯åŠ¨æ–¹å¼

```bash
# ä½¿ç”¨ç®€å•å¯åŠ¨è„šæœ¬
npm run dev:simple

# ä½¿ç”¨Bashè„šæœ¬
npm run dev:bash
```

## ğŸ“¦ é¡¹ç›®æ¨¡å—

### åç«¯æœåŠ¡ (server/)

åŸºäº NestJS æ„å»ºçš„åç«¯ API æœåŠ¡ï¼š

- **ç›‘æ§æ•°æ®æ¥å£**: æ¥æ”¶å’Œå­˜å‚¨å‰ç«¯ä¸ŠæŠ¥çš„ç›‘æ§æ•°æ®
- **æ•°æ®æŸ¥è¯¢æ¥å£**: æä¾›æ•°æ®æŸ¥è¯¢å’Œç»Ÿè®¡åŠŸèƒ½
- **ç”¨æˆ·ç®¡ç†**: ç”¨æˆ·è®¤è¯å’Œæƒé™ç®¡ç†
- **æ•°æ®å¯è§†åŒ–**: ä¸ºç®¡ç†åå°æä¾›æ•°æ®æ¥å£

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
cd server
npm run start:dev
```

### ç®¡ç†åå° (admin/)

åŸºäº React + TypeScript çš„ç®¡ç†ç•Œé¢ï¼š

- **å®æ—¶ç›‘æ§**: å®æ—¶æŸ¥çœ‹é”™è¯¯å’Œæ€§èƒ½æ•°æ®
- **æ•°æ®åˆ†æ**: é”™è¯¯è¶‹åŠ¿ã€æ€§èƒ½æŠ¥å‘Šç­‰
- **ç”¨æˆ·ç®¡ç†**: ç”¨æˆ·å’Œæƒé™ç®¡ç†
- **ç³»ç»Ÿè®¾ç½®**: ç›‘æ§é…ç½®å’Œå‘Šè­¦è®¾ç½®

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
cd admin
npm run dev
```

### SDK

#### Web SDK (sdk/web/)

é€‚ç”¨äºæ™®é€š Web åº”ç”¨çš„ç›‘æ§ SDKï¼š

```javascript
import { createMonitor } from "@monitor/web-sdk";

const monitor = createMonitor({
  projectId: "your-project-id",
  serverUrl: "http://localhost:3001",
});

// è‡ªåŠ¨ç›‘æ§å¼€å§‹å·¥ä½œ
```

#### Taro å°ç¨‹åº SDK (sdk/taroWechatMini/)

é€‚ç”¨äº Taro å¼€å‘çš„å¾®ä¿¡å°ç¨‹åºï¼š

```javascript
import { createMonitor } from "@monitor/taro-wechat-mini-sdk";

const monitor = createMonitor({
  projectId: "your-project-id",
  serverUrl: "http://localhost:3001",
});
```

## ğŸ§ª æµ‹è¯•

é¡¹ç›®åŒ…å«å®Œæ•´çš„æµ‹è¯•å¥—ä»¶ï¼š

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# æ•°æ®æ ¼å¼æµ‹è¯•
npm run test:format

# ç½‘ç»œé”™è¯¯æµ‹è¯•
npm run test:network

# é›†æˆæµ‹è¯•
npm run test:integration

# ç®¡ç†å‘˜åŠŸèƒ½æµ‹è¯•
npm run test:admin
```

## ğŸ“Š ç›‘æ§èƒ½åŠ›

### é”™è¯¯ç›‘æ§

- **JavaScript é”™è¯¯**: è‡ªåŠ¨æ•è·å’Œä¸ŠæŠ¥ JS è¿è¡Œæ—¶é”™è¯¯
- **Promise å¼‚å¸¸**: æ•è·æœªå¤„ç†çš„ Promise rejection
- **ç½‘ç»œè¯·æ±‚é”™è¯¯**: HTTP è¯·æ±‚å¤±è´¥ã€è¶…æ—¶ç­‰
- **èµ„æºåŠ è½½é”™è¯¯**: å›¾ç‰‡ã€è„šæœ¬ç­‰èµ„æºåŠ è½½å¤±è´¥

### æ€§èƒ½ç›‘æ§

- **é¡µé¢æ€§èƒ½**: é¦–å±æ—¶é—´ã€ç™½å±æ—¶é—´ã€èµ„æºåŠ è½½æ—¶é—´
- **ç”¨æˆ·ä½“éªŒæŒ‡æ ‡**: FCPã€LCPã€FIDã€CLS ç­‰ Core Web Vitals
- **ç½‘ç»œæ€§èƒ½**: è¯·æ±‚è€—æ—¶ã€æˆåŠŸç‡ç­‰

### ç”¨æˆ·è¡Œä¸º

- **é¡µé¢è®¿é—®**: PVã€UV ç»Ÿè®¡
- **ç”¨æˆ·æ“ä½œ**: ç‚¹å‡»ã€æ»šåŠ¨ã€è¡¨å•æäº¤ç­‰
- **è‡ªå®šä¹‰äº‹ä»¶**: ä¸šåŠ¡ç›¸å…³çš„è‡ªå®šä¹‰äº‹ä»¶è¿½è¸ª

## ğŸ”§ é…ç½®

### ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶é…ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
# æœåŠ¡ç«¯é…ç½®
SERVER_PORT=3001
DATABASE_URL=mysql://user:password@localhost:3306/monitor

# ç®¡ç†åå°é…ç½®
ADMIN_PORT=5173

# Redisé…ç½® (å¯é€‰)
REDIS_URL=redis://localhost:6379
```

### ç›‘æ§é…ç½®

```javascript
const monitor = createMonitor({
  projectId: "your-project-id",
  serverUrl: "http://localhost:3001",

  // é”™è¯¯ç›‘æ§é…ç½®
  error: {
    filters: [/Script error/], // è¿‡æ»¤è§„åˆ™
    random: 1.0, // é‡‡æ ·ç‡
    ignoreMonitorEndpointErrors: true,
  },

  // æ€§èƒ½ç›‘æ§é…ç½®
  performance: {
    watch: true,
    queueLimit: 20,
  },

  // è¡Œä¸ºç›‘æ§é…ç½®
  behavior: {
    queueLimit: 20,
    isFilterConsole: false,
  },
});
```

## ğŸ› ï¸ å¼€å‘

### æ·»åŠ æ–°åŠŸèƒ½

1. **åç«¯ API**: åœ¨ `server/src/modules/` ä¸‹æ·»åŠ æ–°æ¨¡å—
2. **å‰ç«¯ç•Œé¢**: åœ¨ `admin/src/pages/` ä¸‹æ·»åŠ æ–°é¡µé¢
3. **SDK åŠŸèƒ½**: åœ¨ç›¸åº”çš„ SDK ç›®å½•ä¸‹æ‰©å±•åŠŸèƒ½

### æ„å»ºéƒ¨ç½²

```bash
# æ„å»ºæ‰€æœ‰æ¨¡å—
npm run build

# æ„å»ºç‰¹å®šæ¨¡å—
npm run sdk:taro:build
npm run admin:build
```

## ğŸ“š API æ–‡æ¡£

å¯åŠ¨æœåŠ¡åï¼Œè®¿é—® http://localhost:3001/api-docs æŸ¥çœ‹å®Œæ•´çš„ API æ–‡æ¡£ã€‚

## ğŸ¤ è´¡çŒ®

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº MIT è®¸å¯è¯å¼€æº - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ†˜ æ”¯æŒ

- ğŸ“§ é‚®ç®±: support@monitor-system.com
- ğŸ“– æ–‡æ¡£: [é¡¹ç›®æ–‡æ¡£](docs/)
- ğŸ› é—®é¢˜åé¦ˆ: [GitHub Issues](issues/)

## ğŸ† ç‰¹æ€§

- âœ… **ç±»å‹å®‰å…¨**: å…¨é¢çš„ TypeScript æ”¯æŒ
- âœ… **é«˜æ€§èƒ½**: ä¼˜åŒ–çš„æ•°æ®ä¸ŠæŠ¥å’Œå¤„ç†
- âœ… **æ˜“é›†æˆ**: ç®€å•çš„ SDK é›†æˆæ–¹å¼
- âœ… **å¯æ‰©å±•**: æ¨¡å—åŒ–çš„æ¶æ„è®¾è®¡
- âœ… **å®æ—¶ç›‘æ§**: å®æ—¶æ•°æ®ä¸ŠæŠ¥å’Œå±•ç¤º
- âœ… **å¤šç«¯æ”¯æŒ**: æ”¯æŒå¤šç§å‰ç«¯ç¯å¢ƒ

---

å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æäº¤ Issue æˆ– Pull Requestï¼
